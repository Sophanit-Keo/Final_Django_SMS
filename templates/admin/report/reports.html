{% extends 'layout/admin_sidebar.html' %}
{% load static %}

{% block content %}
<main class="main-content report-dashboard">
    <header class="header">
        <div>
            <h1>Insights & Reports</h1>
            <p class="text-gray-600">Key trends, utilization, and upcoming academic milestones</p>
        </div>
        <div class="header-actions">
            <span class="report-period">Updated {{current_date}}</span>
        </div>
    </header>

    <section class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon primary">üéì</div>
            <div class="stat-content">
                <h3>{{total_students}}</h3><!-- Total Students -->
                <p>Total Students</p>
                <span class="stat-change positive">12 students joined this month</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon success">üë®‚Äçüè´</div>
            <div class="stat-content">
                <h3>{{total_teachers}}</h3>
                <p>Total Teachers</p>
                <span class="stat-change neutral"> active</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon warning">üè´</div>
            <div class="stat-content">
                <h3>{{total_groups}}</h3> <!-- Active Classes -->
                <p>Active Groups</p>
                <span class="stat-change neutral">{{avg_class_size}} avg students / class</span>
            </div>
        </div>
        <div class="stat-card">
            <div class="stat-icon error">‚úÖ</div>
            <div class="stat-content">
                <h3>95.6 %</h3>
                <p>Attendance Today</p>
                <span class="stat-change ">
                    +12 % vs. yesterday
                </span>
            </div>
        </div>
    </section>

    <section class="reports-grid">
        <div class="card">
            <div class="card-header">
                <h3>Upcoming Exams</h3>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Exam</th>
                        <th>Date</th>
                        <th>Max Mark</th>
                    </tr>
                </thead>
                <tbody>
                    {% for exam in exams %}
                    <tr>
                        <td>{{ exam.name }}</td>
                        <td>{{ exam.date }}</td>
                        <td>{{ exam.total_marks }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>Homework Due Soon</h3>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Group</th>
                        <th>Subject</th>
                        <th>Due</th>
                    </tr>
                </thead>
                <tbody>
                    {%for hw in homeworks %}
                    <tr>
                        <td>{{ hw.title }}</td>
                        <td>{{ hw.group_id.name }}</td>
                        <td>{{ hw.subject_id.name }}</td>
                        <td>{{ hw.due_date }}</td>
                    </tr>
                    {% endfor %}

                </tbody>
            </table>
        </div>
    </section>

    <section class="reports-grid">
        <div class="card">
            <div class="card-header">
                <h3>Recent Enrollments</h3>
            </div>
            <ul class="list">
               {%for enrollment in recent_enrollments%}
                <li>
                    <div>
                        <strong>{{enrollment.student_id.first_name}} {{enrollment.student_id.last_name}}</strong>
                        <span class="text-gray-500">{{enrollment.group_id.name}}</span>
                    </div>
                    <span class="text-gray-400">{{enrollment.enrollment_date}}</span>
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="card">
            <div class="card-header">
                <h3>Attendance Snapshot (30 days)</h3>
            </div>
            <table class="table">
                <thead>
                    <tr>
                        <th>Status</th>
                        <th>Count</th>
                        <th>Share</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Present</td>
                        <td>12</td>
                        <td>80%</td>
                    </tr>
                    <tr>
                        <td>Absent</td>
                        <td>2</td>
                        <td>9%</td>
                    </tr>
                    <tr>
                        <td>Late</td>
                        <td>4</td>
                        <td>2%</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
</main>
{% endblock %}